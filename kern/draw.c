#include <inc/string.h>
#include <inc/stdio.h>

#include <kern/video.h>

#define TEXT "my oslab"
#define PIC {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,1,9,9,9,1,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,15,15,15,15,15,0,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,9,9,9,15,15,15,15,0,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,15,0,0,0,0,0,0,1,9,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,\
	1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,15,15,0,0,15,0,0,0,9,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,15,15,0,9,15,15,0,0,9,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,15,0,0,0,15,15,0,0,9,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,15,15,15,15,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,\
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,15,15,15,15,15,15,15,0,0,0,1,1,1,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,\
	0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,15,15,15,15,15,15,15,9,0,0,0,9,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,15,15,15,15,15,15,15,15,15,0,0,0,0,9,9,9,1,1,1,1,1,1,1,0,1,0,0,1,1,\
	1,1,1,1,1,1,0,1,1,1,1,0,0,0,0,0,15,15,15,15,15,15,15,15,15,1,0,1,0,1,9,9,1,1,1,1,1,0,1,1,1,0,1,1,0,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,15,15,15,15,15,15,15,15,15,0,0,9,9,9,9,9,9,1,1,1,1,1,1,1,1,1,0,1,1,\
	1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,15,15,15,15,15,15,15,15,15,0,0,1,1,9,9,9,1,9,1,1,1,1,1,0,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,15,0,15,0,15,9,9,15,0,1,9,9,1,9,9,1,1,1,1,1,1,1,1,1,0,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,9,0,0,15,15,15,0,0,15,0,0,15,15,15,15,0,15,9,9,9,9,9,9,9,1,1,1,1,1,1,1,1,1,\
	1,1,1,0,1,0,1,1,1,1,1,1,0,0,15,15,15,15,15,0,15,0,0,15,15,15,15,0,0,9,9,9,9,9,9,9,9,1,1,1,1,1,1,1,1,\
	1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,15,15,0,0,0,0,0,15,0,15,0,1,1,1,9,9,9,9,9,9,9,1,1,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,9,1,1,0,0,0,0,0,1,0,0,0,0,0,0,1,9,1,9,1,9,9,9,9,9,9,1,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,15,0,1,1,1,1,1,9,1,9,9,1,9,9,1,9,9,9,1,9,9,9,9,9,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,1,1,9,1,1,1,9,1,1,9,1,9,1,9,9,1,9,9,9,9,9,9,1,1,1,1,1,\
	1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,1,1,1,1,9,9,9,1,9,9,9,9,9,1,1,1,1,1,\
	1,1,1,1,1,1,1,1,1,9,15,9,9,9,9,9,9,15,1,1,1,9,15,1,9,9,1,9,1,1,15,9,1,9,9,9,1,9,9,9,1,1,9,1,1,\
	1,1,1,1,1,1,1,1,15,15,15,15,15,15,15,9,15,15,9,1,9,15,15,1,15,15,15,1,9,15,15,15,1,1,9,9,9,9,9,9,9,9,9,9,9,\
	1,1,1,1,1,1,1,1,1,0,1,15,15,1,0,0,15,15,0,1,9,15,15,1,9,15,15,15,15,15,15,0,1,9,1,9,1,9,9,9,9,9,9,9,9,\
	1,1,1,1,1,1,1,1,1,1,9,15,15,0,1,1,15,15,1,1,9,15,15,1,1,9,15,15,15,15,0,1,9,9,1,9,9,9,9,1,9,9,9,9,9,\
	1,1,9,9,1,1,1,1,1,9,9,15,15,1,9,9,15,15,0,1,9,15,15,1,9,1,15,15,15,1,1,9,1,9,9,1,9,9,9,9,9,9,9,9,9,\
	9,9,9,9,1,1,1,1,1,1,9,15,15,1,1,1,15,15,9,1,1,15,15,1,1,15,15,15,15,15,15,9,9,1,9,9,1,9,9,1,9,9,9,9,9,\
	9,9,9,9,9,9,9,1,1,1,1,15,15,0,1,1,15,15,15,15,15,15,15,0,15,15,15,0,9,15,15,9,1,9,9,9,9,9,9,9,9,9,9,9,9,\
	9,9,9,9,9,9,9,9,1,1,1,15,15,0,1,9,1,15,15,15,15,1,0,1,15,15,0,0,1,9,15,15,1,1,1,9,9,9,9,9,9,9,9,9,9,\
	9,9,9,9,9,9,9,9,9,9,1,1,0,1,1,1,1,1,0,1,0,0,1,9,1,1,0,1,9,1,1,0,1,9,9,9,1,9,9,9,9,9,9,9,9}

#define width 45
#define height 32
static int c[width*height]=PIC;

#define TUX
void
redraw_screen() 
{   
	/*Complete here.Just only some lines code*/
#ifdef OSLAB_BIGGER
#define dividor 8000000
	static char buf[256] = TEXT;
	uint32_t adder = 0,counter = 0;
	while(1){
		if((adder%dividor) == dividor-1){
			prepare_buffer();
			counter = (counter+1)%16;
			draw_bigger_string(buf,5*counter,4*counter,counter);
			display_buffer();
		}
		adder++;
	}
#endif
#ifdef OSLAB
#define dividor 8000000
	static char buf[256] = TEXT;
	uint32_t adder = 0,counter = 0;
	while(1){
		if((adder%dividor) == dividor-1){
			prepare_buffer();
			counter = (counter+1)%16;
			draw_string(buf,10*counter,8*counter,counter);
			display_buffer();
		}
		adder++;
	}
#endif
#ifdef TUX
	while(1){
		cprintf("is going to prepare buffer\n");
		prepare_buffer();
		cprintf("has prepared buffer\n");
		int x,y;
		for(y=0;y<height*5;y++){
			for(x=0;x<width*5;x++){
				draw_pixel(y,x,c[y/5*width+x/5]);
			}
		}
		cprintf("is going to display buffer\n");
		display_buffer();
		cprintf("displayed buffer\n");
	}
#endif
#ifdef COLORS
	prepare_buffer();
	int x,y;
	for(x=0;x<256;x++){
		for(y=0;y<160;y++){
			draw_pixel(y,x,0);
		}
	}
	display_buffer();
#endif
}


